<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ANAS GPT - Smartest AI by Anas Nidir</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
</head>
<body>

<!-- Header with toggle -->
<!-- Header with login -->
<header class="main-header">
  <div class="header-top" style="display: flex; justify-content: space-between; align-items: center;">
    <h1>ANAS GPT</h1>
    <div style="display: flex; gap: 10px; align-items: center;">
      <button id="login-btn" class="login-btn">Login</button>
      <button id="logout-btn" style="display: none;" class="logout-btn">Logout</button>
      <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
    </div>
  </div>
</header>

<!-- Sidebar Menu -->
<nav class="sidebar" id="sidebar">
  <ul>
    <li><strong>Ask anything</strong></li>
    <li><button onclick="document.getElementById('login-btn').click()">Login with Google</button></li>
    <li><button onclick="document.getElementById('logout-btn').click()" style="display:none;">Logout</button></li>
    <li><a href="#chat">Chat</a></li>
    <li><a href="#about">About</a></li>
  </ul>
</nav>

<!-- Overlay -->
<div id="sidebar-overlay" onclick="toggleSidebar()" style="display: none;"></div>

<main>
  <div id="login-notice" class="notice" style="display: none; padding: 10px; background: #222; color: #fff; margin-top: 10px; text-align: center; border-radius: 6px;">
    üîê Please <strong>Login with Google</strong> to use ANAS GPT.
  </div>

  <div id="model-dropdown-container" style="position: relative;">
    <button onclick="toggleModelMenu()" id="model-button">
      ü§ñ Select Model
    </button>
    <div id="model-menu" style="display: none;" class="dropdown-menu"></div>
    <input type="hidden" id="model" />
  </div>

  <div id="chat-container"></div>
  <div id="typing-indicator" class="bot message" style="display: none;">Anas GPT is typing...</div>

  <div id="input-area">
    <input type="text" id="user-input" placeholder="Type your question..." onkeydown="if(event.key==='Enter') sendMessage()" />
    <button onclick="sendMessage()">‚û§</button>
  </div>
</main>

<footer>
  ¬© 2025 ANAS GPT by Anas Nidir. All Rights Reserved.
</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";
  import { firebaseConfig } from "./config.js";

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const modelMenu = document.getElementById("model-menu");
  const modelInput = document.getElementById("model");
  const modelButton = document.getElementById("model-button");

  window.toggleModelMenu = function () {
    modelMenu.style.display = modelMenu.style.display === "block" ? "none" : "block";
  };

  async function loadModels() {
    const snapshot = await getDocs(collection(db, "models"));
    modelMenu.innerHTML = "";

    snapshot.forEach((doc) => {
      const data = doc.data();
      if (data.active) {
        const item = document.createElement("div");
        item.textContent = data.name + (data.selected ? " ‚≠ê" : "");
        item.onclick = () => {
          modelInput.value = data.endpoint;
          modelButton.innerHTML = `ü§ñ ${data.name}`;
          modelMenu.style.display = "none";
        };
        modelMenu.appendChild(item);
      }
    });
  }

  loadModels();

  document.addEventListener("click", (e) => {
    const dropdown = document.getElementById("model-menu");
    const button = document.getElementById("model-button");
    if (!dropdown.contains(e.target) && !button.contains(e.target)) {
      dropdown.style.display = "none";
    }
  });
</script>

<script>
  window.toggleSidebar = function () {
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("sidebar-overlay");
    const isOpen = sidebar.classList.toggle("active");
    overlay.style.display = isOpen ? "block" : "none";
  };
</script>

<script type="module" src="script.js"></script>

</body>
</html>
